# [NOI2015] 品酒大会
## 题目背景

## 题目描述
一年一度的“幻影阁夏日品酒大会”隆重开幕了。大会包含品尝和趣味挑战 两个环节，分别向优胜者颁发“首席品酒家”和“首席猎手”两个奖项，吸引了众多品酒师参加。


在大会的晚餐上，调酒师 Rainbow 调制了 $n$ 杯鸡尾酒。这 $n$ 杯鸡尾酒排成一行，其中第 $n$ 杯酒 ($1 ≤ i ≤ n$) 被贴上了一个标签 $s_i$ ，每个标签都是 $26$ 个小写 英文字母之一。设 $str(l, r)$ 表示第 $l$ 杯酒到第 $r$ 杯酒的 $r - l + 1$ 个标签顺次连接构成的字符串。若 $str(p, p_0) = str(q, q_0)$，其中 $1 ≤ p ≤ p_0 ≤ n$, $1 ≤ q ≤ q_0 ≤ n$, $p ≠ q$，$p_0-p+1 = q_0 - q + 1 = r$ ，则称第 $p$ 杯酒与第 $q$ 杯酒是“ $r$ 相似” 的。当然两杯“ $r$ 相似”($r > 1$)的酒同时也是“ $1$ 相似”、“ $2$ 相似”、……、“ $(r - 1)$ 相似”的。特别地，对于任意的 $1 ≤ p ,q ≤ n,p  ≠  q$，第 $p$ 杯酒和第 $q$ 杯酒都 是“ $0$ 相似”的。


在品尝环节上，品酒师 Freda 轻松地评定了每一杯酒的美味度，凭借其专业的水准和经验成功夺取了“首席品酒家”的称号，其中第 $i$ 杯酒 ($1 ≤ i ≤ n$) 的 美味度为 $a_i$ 。现在 Rainbow 公布了挑战环节的问题：本次大会调制的鸡尾酒有一个特点，如果把第 $p$ 杯酒与第 $q$ 杯酒调兑在一起，将得到一杯美味度为 $a_p\times a_q$ 的 酒。现在请各位品酒师分别对于 $r = 0,1,2,⋯,n-1$ ，统计出有多少种方法可以 选出 $2$ 杯“ $r$ 相似”的酒，并回答选择 $2$ 杯“$r$ 相似”的酒调兑可以得到的美味度的最大值。

## 输入格式
第 $1$ 行包含 $1$ 个正整数 $n$ ，表示鸡尾酒的杯数。

第 $2$ 行包含一个长度为 $n$ 的字符串 $S$，其中第 $i$ 个字符表示第 $i$ 杯酒的标签。

第 $3$ 行包含 $n$ 个整数，相邻整数之间用单个空格隔开，其中第 $i$ 个整数表示第 $i$ 杯酒的美味度 $a_i$ 。

## 输出格式
包括 $n$ 行。

第 $i$ 行输出 $2$ 个整数，中间用单个空格隔开。第 $1$ 个整 数表示选出两杯“ $(i - 1)$ 相似”的酒的方案数，第 2 个整数表示选出两杯 “ $(i - 1)$ 相似”的酒调兑可以得到的最大美味度。若不存在两杯“ $(i - 1)$ 相似” 的酒，这两个数均为 $0$ 。

#### 输入 \#1
```
10
ponoiiipoi
2 1 4 7 4 8 3 6 4 7
```
### 输出 \#1
```
45 56
10 56
3 32
0 0
0 0
0 0
0 0
0 0
0 0
0 0
```
### 输入 \#1
```
12
abaabaabaaba
1 -2 3 -4 5 -6 7 -8 9 -10 11 -12

```
### 输出 \#1
```
66 120
34 120
15 55
12 40
9 27
7 16
5 7
3 -4
2 -4
1 -4
0 0
0 0
```
## 说明/提示
【样例说明 1】

用二元组 $(p, q)$ 表示第 $p$ 杯酒与第 $q$ 杯酒。

$0$ 相似：所有 $45$ 对二元组都是 $0$ 相似的，美味度最大的是 $8 × 7 = 56$。

$1$ 相似： $(1,8) (2,4) (2,9) (4,9) (5,6) (5,7) (5,10) (6,7) (6,10) (7,10)$，最大的 $8 × 7 = 56$ 。

$2$ 相似： $(1,8) (4,9) (5,6)$ ，最大的 $4 × 8 = 32$ 。

没有 $3,4,5, ⋯ ,9$ 相似的两杯酒，故均输出 $0$ 。



 ![](https://cdn.luogu.com.cn/upload/pic/1508.png) 

【时限1s，内存512M】

# [NOI2011] 阿狸的打字机
## 题目背景

## 题目描述
阿狸喜欢收藏各种稀奇古怪的东西，最近他淘到一台老式的打字机。打字机上只有 $28$ 个按键，分别印有 $26$ 个小写英文字母和 `B`、`P` 两个字母。经阿狸研究发现，这个打字机是这样工作的：

* 输入小写字母，打字机的一个凹槽中会加入这个字母(这个字母加在凹槽的最后)。
* 按一下印有 `B` 的按键，打字机凹槽中最后一个字母会消失。
* 按一下印有 `P` 的按键，打字机会在纸上打印出凹槽中现有的所有字母并换行，但凹槽中的字母不会消失。

例如，阿狸输入 `aPaPBbP`，纸上被打印的字符如下：

```
a
aa
ab
```

我们把纸上打印出来的字符串从 $1$ 开始顺序编号，一直到 $n$。打字机有一个非常有趣的功能，在打字机中暗藏一个带数字的小键盘，在小键盘上输入两个数 $(x,y)$（其中 $1\leq x,y\leq n$），打字机会显示第 $x$ 个打印的字符串在第 $y$ 个打印的字符串中出现了多少次。

阿狸发现了这个功能以后很兴奋，他想写个程序完成同样的功能，你能帮助他么？

## 输入格式
输入的第一行包含一个字符串，按阿狸的输入顺序给出所有阿狸输入的字符。

第二行包含一个整数 $m$，表示询问个数。

接下来 $m$ 行描述所有由小键盘输入的询问。其中第 $i$ 行包含两个整数 $x, y$，表示第 $i$ 个询问为 $(x, y)$。

## 输出格式
输出 $m$ 行，其中第 $i$ 行包含一个整数，表示第 $i$ 个询问的答案。

#### 输入 \#1
```
aPaPBbP
3
1 2
1 3
2 3
```
### 输出 \#1
```
2
1
0
```
## 说明/提示
### 数据范围

对于 $100\%$ 的数据，$1\leq n\leq 10^5$，$1\leq m\leq10^5$，第一行总长度 $\leq 10^5$。

|测试点|$n$ 的规模|$m$ 的规模|字符串长度|第一行长度|
|:-:|:-:|:-:|:-:|:-:|
|$1,2$|$1\leq n\leq 100$|$1\leq m\leq 10^3$| - |$\leq 100$|
|$3,4$|$1\leq n\leq 10^3$|$1\leq m\leq 10^4$|单个长度 $\leq 10^3$，总长度 $\leq 10^5$|$\leq 10^5$|
|$5\sim 7$|$1\leq n\leq 10^4$|$1\leq m\leq 10^5$|总长度 $\leq 10^5$|$\leq 10^5$|
|$8\sim 10$|$1\leq n\leq 10^5$|$1\leq m\leq 10^5$| - |$\leq 10^5$|


# [SCOI2016] 围棋
## 题目背景

## 题目描述
近日，谷歌研发的围棋 AI——AlphaGo 以 $4:1$ 的比分战胜了曾经的世界冠军李世石，这是人工智能领域的又一里程碑。

与传统的搜索式 AI 不同，AlphaGo 使用了最近十分流行的卷积神经网络模型。在卷积神经网络模型中，棋盘上每一块特定大小的区域都被当做一个窗口。例如棋盘的大小为 $5\times 6$，窗口大小为 $2\times 4$，那么棋盘中共有 $12$ 个窗口。此外，模型中预先设定了一些模板，模板的大小与窗口的大小是一样的。

下图展现了一个 $5\times 6$ 的棋盘和两个 $2\times 4$ 的模板：

![](https://i.loli.net/2020/03/05/24yfVvrmNScWF5g.jpg)

对于一个模板，只要棋盘中有某个窗口与其完全匹配，我们称这个模板是被激活的，否则称这个模板没有被激活。

例如图中第一个模板就是被激活的，而第二个模板就是没有被激活的。我们要研究的问题是：对于给定的模板，有多少个棋盘可以激活它。

为了简化问题，我们抛开所有围棋的基本规则，只考虑一个 $n\times m$ 的棋盘，每个位置只能是黑子、白子或无子三种情况，换句话说，这样的棋盘共有 $3^{n\times m}$ 种。此外，我们会给出 $q$ 个 $2\times c$ 的模板。

我们希望知道，对于每个模板，有多少种棋盘可以激活它。强调：模板一定是两行的。

## 输入格式
输入数据的第一行包含四个正整数 $n,m,c$ 和 $q$，分别表示棋盘的行数、列数、模板的列数和模板的数量。

随后 $2\times q$ 行，每连续两行描述一个模板。其中，每行包含 $c$ 个字符，字符一定是 ```W```，```B``` 或 ```X``` 中的一个，表示白子、黑子或无子三种情况的一种。
## 输出格式
输出应包含 $q$ 行，每行一个整数，表示符合要求的棋盘数量。由于答案可能很大，你只需要输出答案对 $10^9+7$ 取模后的结果即可。

#### 输入 \#1
```
3 1 1 2
B
W
B
B
```
### 输出 \#1
```
6
5
```
## 说明/提示
对于所有测试点：$1\leq n\leq 100$，$1\leq m\leq 12$，$1\leq c\leq 6$，$1\leq q\leq 5$。

| 测试点编号 | 约定 |
| :----------: | :----------: |
| $1$ | $n=3$，$m=4$，$c=2$ |
| $2$ | $n=4$，$m=4$，$c=3$ |
| $3$ | $n=2$，$m=9$，$c=6$ |
| $4$ | $n=2$，$m=12$，$c=3$ |
| $5$ | $n=2$，$m=12$，$c=5$ |
| $6$ | $n=10$，$m=8$，$c=3$ |
| $7$ | $n=10$，$m=10$，$c=5$ |
| $8$ | $n=100$，$m=10$，$c=5$ |
| $9$ | $n=100$，$m=12$，$c=5$ |
| $10$ | $n=100$，$m=12$，$c=6$ |
# [BJOI2017] 魔法咒语
## 题目背景

## 题目描述
Chandra 是一个魔法天才。

从一岁时接受火之教会洗礼之后，Chandra 就显示出对火元素无与伦比的亲和力，轻而易举地学会种种晦涩难解的法术。这也多亏 Chandra 有着常人难以企及的语言天赋，让她能轻松流利地说出咒语中那些极其拗口的魔法词汇。

直到十四岁，开始学习威力强大的禁咒法术时，Chandra 才遇到了障碍。

根据火之魔法规则，禁咒的构成单位是 $N$ 个基本词汇。施法时只要凝聚精神力，说出一段用这些词语组成的长度恰好等于 $L$ 的语言，就能释放威力超乎想象的火法术。过去的魔法师们总结了几种表达起来最连贯的组合方式，方便施法者以最快语速完成法术。

但具有魔法和语言双重天才的 Chandra 不满足于这几种流传下来的禁咒，因为她可以毫无困难地说出普通人几乎不可能表达的禁咒语句。然而，在实际施法时，Chandra 发现有些自创禁咒念出后不但没有预期效果，反而会使自己的精神力迅速枯竭，十分难受。

这个问题令 Chandra 万分不解。她大量阅读典籍，到处走访魔法学者，并且不顾精神折磨一次又一次尝试新咒语，希望找出问题的答案。

很多年过去了，在一次远古遗迹探险中，Chandra 意外闯进了火之神艾利克斯的不知名神殿。根据岩土特征分析，神殿应该有上万年的历史，这是极其罕见的。Chandra 小心翼翼地四处探索，沿着魔力流动来到一间密室。她看见密室中央悬浮着一本书籍。在魔法保护下书籍状况完好。精通上古语言的 Chandra 读过此书，终于解开了多年的困惑。


禁咒法术之所以威力强大，是因为咒语借用了火之神艾利克斯的神力。这本书里记载了艾利克斯生平忌讳的 $M$ 个词语，比如情敌的名字、讨厌的植物等等。使用禁咒法术时，如果语言中含有任何忌讳词语，就会触怒神力而失效，施法者也一并遭受惩罚。

例如，若 `banana` 是唯一的忌讳词语，`an`、`ban`、`analysis` 是基本词汇，禁咒长度须是 $11$，则 `bananalysis` 是无效法术，`analysisban`、`anbanbanban` 是两个有效法术。注意：一个基本词汇在禁咒法术中可以出现零次、一次或多次；只要组成方式不同就认为是不同的禁咒法术，即使书写形式相同。

谜题破解，Chandra 心情大好。她决定计算一共有多少种有效的禁咒法术。

由于答案可能很大，你只需要输出答案模 $10 ^ 9 + 7$ 的结果。

## 输入格式
第一行，三个正整数 $N, M, L$。

接下来 $N$ 行，每行一个只含小写英文字母的字符串，表示一个基本词汇。

接下来 $M$ 行，每行一个只含小写英文字母的字符串，表示一个忌讳词语。

## 输出格式
仅一行，一个整数，表示答案（模 $10^9+7$）。

#### 输入 \#1
```
4 2 10
boom
oo
ooh
bang
ob
mo
```
### 输出 \#1
```
14
```
### 输入 \#1
```
3 1 3
a
ab
aba
aaa
```
### 输出 \#1
```
3
```
### 输入 \#1
```
3 1 14
ban
an
analysis
banana
```
### 输出 \#1
```
15
```
## 说明/提示
【样例解释 1】

有效的禁咒法术共有 $14$ 种：`boom/bang/oo`，`oo/oo/oo/oo/oo`，`oo/oo/ooh/ooh`，`oo/ooh/oo/ooh`，`oo/ooh/ooh/oo`，`ooh/oo/oo/ooh`，`ooh/oo/ooh/oo`，`
ooh/ooh/boom`，`ooh/ooh/oo/oo`，`ooh/ooh/bang`，`ooh/bang/ooh`，`bang/oo/oo/oo`，`bang/ooh/ooh`，`bang/bang/oo`。

【样例解释 2】

有效的禁咒法术有 `a/ab`，`ab/a`，`aba` 共三种。注意，`ab/a` 和 `aba` 算成两种不同的禁咒法术。

【数据规模与约定】

本题一共有 $10$ 个测试点。

下表是每个测试点的数据规模和约定：

 ![](https://cdn.luogu.com.cn/upload/pic/5191.png) 

对于 $100\%$ 的数据，$1 \le N, M \le 50，1 \le L \le 10^8$，基本词汇的长度之和不超过 $100$，忌讳词语的长度之和不超过 $100$。保证基本词汇不重复，忌讳词语不重复。

# [NOI2018] 你的名字
## 题目背景
实力强大的小 A 被选为了 ION2018 的出题人，现在他需要解决题目的命名问题。
## 题目描述
小 A 被选为了 ION2018 的出题人，他精心准备了一道质量十分高的题目，且已经把除了题目命名以外的工作都做好了。

由于 ION 已经举办了很多届，所以在题目命名上也是有规定的，ION 命题手册规定：每年由命题委员会规定一个小写字母字符串，我们称之为那一年的命名串，要求每道题的名字必须是那一年的命名串的一个非空连续子串，且不能和前一年的任何一道题目的名字相同。

由于一些特殊的原因，小 A 不知道 ION2017 每道题的名字，但是他通过一些特殊手段得到了 ION2017 的命名串，现在小 A 有 $Q$ 次询问：每次给定 ION2017 的命名串和 ION2018 的命名串，求有几种题目的命名，使得这个名字一定满足命题委员会的规定，即是 ION2018 的命名串的一个非空连续子串且一定不会和 ION2017 的任何一道题目的名字相同。

由于一些特殊原因，所有询问给出的 ION2017 的命名串都是某个串的连续子串，详细可见输入格式。


## 输入格式
第一行一个字符串 $S$ ，之后询问给出的 ION2017 的命名串都是 $S$ 的连续子串。
第二行一个正整数 $Q$，表示询问次数。
接下来 $Q$ 行，每行有一个字符串 $T$ 和两个正整数$l,r$，表示询问如果 ION2017 的命名串是 $S_{l\ldots r}$，ION2018 的命名串是 $T$ 的话，有几种命名方式一定满足规定。
## 输出格式
输出 $Q$ 行，第 $i$ 行一个非负整数表示第 $i$ 个询问的答案。
#### 输入 \#1
```
scbamgepe
3
smape 2 7
sbape 3 8
sgepe 1 9
```
### 输出 \#1
```
12
10
4
```
## 说明/提示
### 更多样例

更多样例请在附加文件中下载。

#### 样例 2

见附加文件中的 `name2.in` 与 `name2.ans`。

### 数据范围

|测试点|$\| S\| \leq$　|$Q\leq$　|$\sum \| T\| \leq$　|其他限制|
|:-:|:-:|:-:|:-:|:-:|
|$1$|$200$|$200$|$40000$|$T\leq 200$|
|$2$|$1000$|$200$|$40000$|$T\leq 200$|
|$3$|$1000$|$200$|$40000$|$T\leq 200$|
|$4$|$1000$|$200$|$5 \times 10^5$|无|
|$5$|$1000$|$200$|$5 \times 10^5$|无|
|$6$|$5 \times 10^5$|$1$|$5 \times 10^5$|无|
|$7$|$5 \times 10^5$|$1$|$5 \times 10^5$|无|
|$8$|$10^5$|$10^5$|$2 \times 10^5$|无|
|$9$|$10^5$|$10^5$|$2 \times 10^5$|字符串随机|
|$10$|$2 \times 10^5$|$10^5$|$4 \times 10^5$|无|
|$11$|$2 \times 10^5$|$10^5$|$4 \times 10^5$|字符串随机|
|$12$|$3 \times 10^5$|$10^5$|$6 \times 10^5$|无|
|$13$|$3 \times 10^5$|$10^5$|$6 \times 10^5$|字符串随机|
|$14$|$4 \times 10^5$|$10^5$|$8 \times 10^5$|无|
|$15$|$4 \times 10^5$|$10^5$|$8 \times 10^5$|字符串随机|
|$16$|$5 \times 10^5$|$10^5$|$10^6$|无|
|$17$|$5 \times 10^5$|$10^5$|$10^6$|字符串随机|
|$18$|$2 \times 10^5$|$10^5$|$10^6$|无|
|$19$|$3 \times 10^5$|$10^5$|$10^6$|无|
|$20$|$4 \times 10^5$|$10^5$|$10^6$|无|
|$21$|$5 \times 10^5$|$10^5$|$10^6$|无|
|$22$|$5 \times 10^5$|$10^5$|$10^6$|无|
|$23$|$5 \times 10^5$|$10^5$|$10^6$|无|
|$24$|$5 \times 10^5$|$10^5$|$10^6$|无|
|$25$|$5 \times 10^5$|$10^5$|$10^6$|无|

对于前 $17$ 个测试点的所有询问有 $l=1,r=|S|$。

对于所有数据，保证 $1\leq l \leq r \leq |S|$,$1\leq |T|\leq 5 \times 10^5$

感谢 @Wen_kr 提供的一组 hack 数据。
# [SHOI2011] 双倍回文
## 题目背景

## 题目描述
记字符串 $w$ 的倒置为 $w^{\mathsf R}$。例如$\tt (abcd)^{\mathsf R}=dcba$，$\tt (abba)^{\mathsf R}=abba$。

对字符串 $x$，如果 $x$ 满足 $x^{\mathsf R}=x$，则称之为回文。例如 $\tt abba$ 是一个回文，而 $\tt abed$ 不是。

如果 $x$ 能够写成 $ww^{\mathsf R} ww^{\mathsf R}$ 形式，则称它是一个“双倍回文”。换句话说，若要 $x$ 是双倍回文，它的长度必须是 $4$ 的倍数，而且 $x$，$x$ 的前半部分，$x$ 的后半部分都要是回文。例如 $\tt abbaabba$ 是一个双倍回文，而 $\tt abaaba$ 不是，因为它的长度不是 $4$ 的倍数。

- $x$ 的子串是指在 $x$ 中连续的一段字符所组成的字符串。例如 $\tt be$ 是 $\tt abed$ 的子串，而 $\tt ac$ 不是。
- $x$ 的回文子串，就是指满足回文性质的 $x$ 的子串。
- $x$ 的双倍回文子串，就是指满足双倍回文性质的 $x$ 的子串。

你的任务是，对于给定的字符串，计算它的最长双倍回文子串的长度。
## 输入格式
输入分为两行。

第一行为一个整数，表示字符串的长度。  
第二行有个连续的小写的英文字符，表示字符串的内容。
## 输出格式
输出文件只有一行即输入数据中字符串的最长双倍回文子串的长度，如果双倍回文子串不存在，则输出 $0$。
#### 输入 \#1
```
16
ggabaabaabaaball
```
### 输出 \#1
```
12
```
## 说明/提示
### 数据范围及约定

对于全部数据，$1\le N \le 500000$。
# [COCI2015] Divljak
## 题目背景

## 题目描述
Alice 有 $n$ 个字符串 ${S}_1, {S}_2, \ldots, {S}_n$，Bob 有一个字符串集合 ${T}$，一开始集合是空的。

接下来会发生 $q$ 个操作，操作有两种形式：

1. `1 P`：Bob 往自己的集合里添加了一个字符串 ${P}$。
2. `2 x`：Alice 询问 Bob，集合 ${T}$ 中有多少个字符串包含串 ${S}_x$（我们称串 ${A}$ 包含串 ${B}$，当且仅当 ${B}$ 是 ${A}$ 的子串）。
## 输入格式
第一行一个整数 $n$。

接下来 $n$ 行，第 $i$ 行一个字符串 ${S}_i$。

接下来一行一个整数 $q$。

接下来 $q$ 行，每行一个操作。
## 输出格式
对每个 `2 x` 操作，一行一个整数，表示答案。
#### 输入 \#1
```
3
a
bc
abc
5
1 abca
2 1
1 bca
2 2
2 3

```
### 输出 \#1
```
1
2
1

```
## 说明/提示
对于 $100\%$ 的数据，$1 \leq n,q \leq 10^5$，字符串由小写字母构成，$S$ 和 $P$ 的总长分别 $\le 2 \times 10^6$。

# [LNOI2022] 串
## 题目背景

## 题目描述
为了让你更好地理解题面，给出若干关于字符串的定义：

- 对于一个字符串 $S = s_1 s_2 \cdots s_n$，定义其长度为 $\lvert S \rvert = n$。
- 对于两个字符串 $S = s_1 s_2 \cdots s_n$ 和 $T = t_1 t_2 \cdots t_m$，称 $T$ 为 $S$ 的子串，若 $m = 0$（即 $T$ 为空串）或者 $\exists 1 \le i \le j \le n$，$T = s_i s_{i + 1} \cdots s_j$。若 $m = 0$ 或上述判断条件中 $i$ 可以取到 $1$，则称 $T$ 为 $S$ 的前缀；若 $m = 0$ 或上述判断条件中 $j$ 可以取到 $n$，则称 $T$ 为 $S$ 的后缀。

给定一个英文小写字母构成的字符串 $S$，你需要找到一个尽可能长的字符串序列 $(T_0, T_1, \ldots, T_l)$，满足：

- $T_0$ 是 $S$ 的子串；
- $\forall 1 \le i \le l$，$\lvert T_i \rvert - \lvert T_{i - 1} \rvert = 1$；
- $\forall 1 \le i \le l$，存在 $S$ 的一个长度为 $\lvert T_i \rvert + 1$ 的子串 $S'_i$，使得 $S'_i$ 的长度为 $\lvert T_{i - 1} \rvert$ 的前缀为 $T_{i - 1}$，长度为 $\lvert T_i \rvert$ 的后缀为 $T_i$。

输出这样的字符串序列的长度的最大值（即 $l$ 的最大值）。
## 输入格式
**本题有多组测试数据**。输入的第一行为一个整数 $T$，表示测试数据组数。对于每组测试数据，输入一行一个英文小写字母构成的字符串 $S$。
## 输出格式
对于每组测试数据输出一行一个整数，表示题目描述中字符串序列长度的最大值。
#### 输入 \#1
```
3
abcd
abab
a

```
### 输出 \#1
```
2
3
0

```
## 说明/提示
**【样例解释 \#1】**

下文中使用符号 $\epsilon$ 表示空串。

对于第一组测试数据，可以找到如下字符串序列：$T_0 = \epsilon, T_1 = \texttt{b}, T_2 = \texttt{cd}$，其中 $S'_1 = \texttt{ab}, S'_2 = \texttt{bcd}$。

对于第二组测试数据，可以找到如下字符串序列：$T_0 = \epsilon, T_1 = \texttt{b}, T_2 = \texttt{ab}, T_3 = \texttt{bab}$，其中 $S'_1 = \texttt{ab}, S'_2 = \texttt{bab}, S'_3 = \texttt{abab}$。

对于第三组测试数据，可以找到如下字符串序列：$T_0 = \epsilon$。

**【样例 \#2】**

见附件中的 `string/string2.in` 与 `string/string2.ans`。

该组样例中的字符串长度有一定梯度，你可以利用该组样例对程序进行检查。

**【样例 \#3】**

见附件中的 `string/string3.in` 与 `string/string3.ans`。

该组样例满足特殊性质 A。

**【数据范围】**

设 $\sum |S|$ 表示测试点中所有测试数据的字符串长度和。

对于 $100 \%$ 的测试数据，$T \ge 1$，$1 \le \lvert S \rvert \le 5 \times {10}^5$，$1 \le \sum \lvert S \rvert \le 1.5 \times {10}^6$。

| 测试点编号 | $\lvert S \rvert \le$ | $\sum \lvert S \rvert \le$ | 特殊性质 |
|:-:|:-:|:-:|:-:|
| $1 \sim 2$ | $30$ | $150$ | 无 |
| $3 \sim 5$ | $200$ | $800$ | 无 |
| $6 \sim 8$ | $1000$ | $3000$ | 无 |
| $9 \sim 11$ | $5 \times {10}^5$ | $1.5 \times {10}^6$ | A |
| $12 \sim 15$ | $6 \times {10}^4$ | $3 \times {10}^5$ | 无 |
| $16 \sim 20$ | $5 \times {10}^5$ | $1.5 \times {10}^6$ | 无 |

特殊性质 A：字符串中的每个字符在小写字母中独立均匀随机生成。

**【提示】**

本题输入输出量较大，请使用较为快速的输入输出方式。

例如，若你的代码使用了 `cin` 和 `cout` 作为输入输出方式，你可以选择在代码的**输入输出重定向语句**（`freopen` 语句、 `fopen` 语句等）**之后**加入以下语句加速输入输出速度。

```cpp
ios::sync_with_stdio(0); cin.tie(0); cout.tie(0);
```

**加入该语句后不建议同时使用 `cin, cout` 和其他输入输出方式。**
# Angels & Demons
## 题目背景
教皇内侍已经感觉到了身体上的疼痛。疼痛迅速传遍了全身，让他想抓想挠。

>不要忘记耶稣所遭受的痛苦。

他感觉喉咙中有种火烧火燎般的疼痛，就连吗啡都无法将之化解。

>我在这里的事情已经做完了。

他激起了人们的敬畏之心，人们又有了希望。

在帕利恩凹室里的时候，教皇内侍遵从上帝的教诲，举行了涂油仪式。他的身体上，发须上，面颊上，麻布长袍上，全身都涂满了灯油。他这会儿像是浸泡在神圣的绿色灯油中一样，气味芬芳，如母亲的体香，可却易燃烧。他将会幸运地升天。那是个充满奇迹而又迅速的过程。他留给世人的不再是丑闻……而是一股新的力量和奇迹。

他的手滑入长袍的口袋，摸出从帕利恩凹室里拿来的小小的金色打火机。

他低声说出了上帝在最后审判时说过的一句话。

>熊熊烈焰直冲云霄，上帝的天使也会在火焰中升天。

他的大拇指按在了打火机上。

人们还在圣彼得广场上唱着颂歌……
## 题目描述
给定 $n$ 个由小写字母组成的模板串 $S_{1...n}$，$q$ 组询问，询问分为以下两种类型：

1. `1 T`：给定一个由小写字母组成的询问串 $T$。
2. `2 p l r`：设 $num(p,l,r)$ 表示 $S_p$ 的 $[l,r]$ 子串是多少个询问串的子串，求 $\max\limits_{i=1}^{l}(num(p,i,r))$。
## 输入格式
第一行，两个数 $n,q,w_0$，其中 $w_0$ 表示数据类型。

* $w_0=0$：
  
  第 $2\sim n+1$ 行，每行一个字符串，第 $i+1$ 行表示 $S_i$。
  
  接下来 $q$ 行，每行一组询问，格式如题。
* $w_0=1$：
  
  第二行，输入三个整数 $A,B,C$。
  
  接下来 $n$ 行，每行一个字符串，表示一个模板串。
  
  接下来，询问按照如下代码生成（代码中的 ```lst``` 表示上一次询问 $2$ 的答案，初始时为 $0$，```le[i]``` 表示模板串 $i$ 的长度，```s``` 是 char 数组）：
  
```cpp
while (q--) {
	int op;
	scanf("%d", &op);
	if (op == 1) {
		scanf("%s", s + 1);
		int x((1ll * A * lst + B) % C), l(strlen(s + 1));
		for (int i(1); i <= l; ++i) {
			swap(s[i], s[x % l + 1]);
			x = (1ll * A * x + B) % C;
		}
	} else {
		int p, l, r;
		scanf("%d%d%d", &p, &l, &r);
		int x((1ll * A * lst + B) % C);
		p = (p + x) % n + 1;
		x = (1ll * A * x + B) % C;
		l = (l + x) % le[p] + 1;
		x = (1ll * A * x + B) % C;
		r = (r + x) % le[p] + 1;
		if (l > r) swap(l, r);
		// 此处更新 lst
	}
}
```

## 输出格式
对于每个询问 $2$，输出一行一个整数表示答案。
#### 输入 \#1
```
5 11 0
abb
aab
baab
bbaa
aabbb
1 ab
2 1 1 3
2 2 2 3
1 ba
2 3 1 2
2 4 1 2
2 4 2 3
1 abb
2 5 2 4
2 1 1 3
2 1 1 2

```
### 输出 \#1
```
0
1
1
0
1
1
1
2

```
### 输入 \#1
```
5 11 1
114 514 1919810
abb
aab
baab
bbaa
aabbb
1 ab
2 1 1 3
2 2 2 3
1 ba
2 3 1 2
2 4 1 2
2 4 2 3
1 abb
2 5 2 4
2 1 1 3
2 1 1 2

```
### 输出 \#1
```
0
0
1
0
0
1
1
0

```
## 说明/提示
对于 $100\%$ 数据：$1\le n,q\le 10^5$，$\sum\limits_{i=1}^{n}|S_i|\le5\times10^5$，$\sum|T|\le5\times10^5$，$1\le p\le n$，$w_0\in\{0,1\}$，$1\le A,B<C\le10^9$。

|测试点|分值|$n\le$|$\sum\limits_{i=1}^{n}\|S_i\|\le$|$q\leq$|$\sum \| T\| \leq$|$w_0=$|其他限制|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|$1$|$3$|$20$|$200$|$200$|$5000$|$0$|无|
|$2$|$3$|$200$|$2000$|$200$|$5000$|$0$|无|
|$3$|$3$|$200$|$2000$|$200$|$5000$|$0$|无|
|$4$|$3$|$200$|$2000$|$200$|$5\times10^5$|$0$|无|
|$5$|$3$|$200$|$2000$|$200$|$5\times10^5$|$0$|无|
|$6$|$3$|$1$|$5\times10^5$|$2$|$5\times10^5$|$0$|无|
|$7$|$3$|$1$|$5\times10^5$|$2$|$5\times10^5$|$0$|无|
|$8$|$4$|$10^5$|$10^5$|$10^5$|$10^5$|$0$|无|
|$9$|$3$|$10^5$|$10^5$|$10^5$|$10^5$|$0$|字符串随机|
|$10$|$4$|$10^5$|$2 \times 10^5$|$10^5$|$2 \times 10^5$|$0$|无|
|$11$|$3$|$10^5$|$2 \times 10^5$|$10^5$|$2 \times 10^5$|$0$|字符串随机|
|$12$|$4$|$10^5$|$3 \times 10^5$|$10^5$|$3 \times 10^5$|$0$|无|
|$13$|$3$|$10^5$|$3 \times 10^5$|$10^5$|$3 \times 10^5$|$0$|字符串随机|
|$14$|$4$|$10^5$|$4 \times 10^5$|$10^5$|$4 \times 10^5$|$0$|无|
|$15$|$3$|$10^5$|$4 \times 10^5$|$10^5$|$4 \times 10^5$|$0$|字符串随机|
|$16$|$4$|$10^5$|$5\times10^5$|$10^5$|$5\times10^5$|$0$|无|
|$17$|$3$|$10^5$|$5\times10^5$|$10^5$|$5\times10^5$|$0$|字符串随机|
|$18$|$3$|$10^5$|$2 \times 10^5$|$10^5$|$5\times10^5$|$0$|无|
|$19$|$3$|$10^5$|$3 \times 10^5$|$10^5$|$5\times10^5$|$0$|无|
|$20$|$3$|$10^5$|$4 \times 10^5$|$10^5$|$5\times10^5$|$0$|无|
|$21$|$3$|$10^5$|$5\times10^5$|$10^5$|$5\times10^5$|$0$|字符串随机|
|$22$|$3$|$10^5$|$5\times10^5$|$10^5$|$5\times10^5$|$0$|无|
|$23$|$3$|$10^5$|$5\times10^5$|$10^5$|$5\times10^5$|$0$|无|
|$24$|$3$|$10^5$|$5\times10^5$|$10^5$|$5\times10^5$|$0$|无|
|$25$|$3$|$10^5$|$5\times10^5$|$10^5$|$5\times10^5$|$0$|无|
|$26$|$4$|$10^5$|$3\times10^5$|$10^5$|$5\times10^5$|$1$|无|
|$27$|$4$|$10^5$|$4\times10^5$|$10^5$|$5\times10^5$|$1$|无|
|$28$|$4$|$10^5$|$5\times10^5$|$10^5$|$5\times10^5$|$1$|无|
|$29$|$4$|$10^5$|$5\times10^5$|$10^5$|$5\times10^5$|$1$|无|
|$30$|$4$|$10^5$|$5\times10^5$|$10^5$|$5\times10^5$|$1$|无|

**测试点 $8\sim 17$ 保证对于所有询问 $2$，$l=1$。**
# 回文匹配
## 题目背景

## 题目描述
对于一对字符串 $(s_1,s_2)$，若 $s_1$ 的长度为奇数的子串 $(l,r)$ 满足 $(l,r)$ 是回文的，那么 $s_1$ 的“分数”会增加 $s_2$ 在 $(l,r)$ 中出现的次数。

现在给出一对 $(s_1,s_2)$，请计算出 $s_1$ 的“分数”。

答案对 $2 ^ {32}$ 取模。
## 输入格式
第一行两个整数，$n,m$，表示 $s_1$ 的长度和 $s_2$ 的长度。

第二行两个字符串，$s_1,s_2$。
## 输出格式
一行一个整数，表示 $s_1$ 的分数。
#### 输入 \#1
```
10 2
ccbccbbcbb bc
```
### 输出 \#1
```
4
```
### 输入 \#1
```
20 2
cbcaacabcbacbbabacca ba

```
### 输出 \#1
```
4

```
## 说明/提示
**【样例解释】**

   对于样例一：

   子串 $(1,5)$ 中 $s_2$ 出现了一次，子串 $(2,4)$ 中 $s_2$ 出现了一次。

   子串 $(7,9)$ 中 $s_2$ 出现了一次，子串 $(6,10)$ 中 $s_2$ 出现了一次。

--------------------------------------

**【数据范围】**

**本题采用捆绑测试。**

- 对于 $100\%$ 的数据：$1 \le n,m \le 3 \times 10 ^ 6$，字符串中的字符都是小写字母。

- **详细的数据范围：**

  | Subtask 编号 |     $n,m \le$     | 分值 |
  | :----------: | :---------------: | :--: |
  |     $1$      |       $100$       | $15$ |
  |     $2$      |     $10 ^ 3$      | $15$ |
  |     $3$      | $5 \times 10 ^ 3$ | $20$ |
  |     $4$      | $4 \times 10 ^ 5$ | $30$ |
  |     $5$      | $3 \times 10 ^ 6$ | $20$ |
# [SDOI2014] 数数
## 题目背景

## 题目描述
我们称一个正整数 $x$ 是幸运数，当且仅当它的十进制表示中不包含数字串集合 $s$ 中任意一个元素作为其子串。例如当 $s = \{22, 333, 0233\}$ 时，$233$ 是幸运数，$2333$、$20233$、$3223$ 不是幸运数。给定 $n$ 和 $s$，计算不大于 $n$ 的幸运数个数。

答案对 $10^9 + 7$ 取模。
## 输入格式
第一行有一个整数，表示 $n$。

第二行有一个整数，表示 $s$ 中的元素个数 $m$。

接下来 $m$ 行，每行一个数字串 $s_i$，表示 $s$ 中的一个元素。
## 输出格式
输出一行一个整数，表示答案对 $10^9 + 7$ 取模的结果。
#### 输入 \#1
```
20
3
2
3
14
```
### 输出 \#1
```
14
```
## 说明/提示
#### 样例 1 解释

除了 $3, 13, 2, 12, 20, 14$ 以外，不大于 $20$ 的整数都是幸运数字。

#### 数据规模与约定

对于全部的测试点，保证：

$1 \leq n < 10^{1201}$，$1 \leq m \leq 100$，$1 \leq \sum_{i = 1}^m |s_i| \leq 1500$，$\min_{i = 1}^m |s_i| \geq 1$，其中 $|s_i|$ 表示字符串 $s_i$ 的长度。$n$ 没有前导 $0$，但是 $s_i$ 可能有前导 $0$。
# [CERC2018] The ABCD Murderer
## 题目背景

## 题目描述
**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [The ABCD Murderer](https://contest.felk.cvut.cz/18cerc/solved/abcd.pdf)**

Oscar 特别喜欢看犯罪电影。他钦佩那些罪犯，因为他们富有创造力。他也想展示他的创造力。但很可惜的是，他没什么经验，也想不出来什么原创伎俩。所以他想从已有的招数中寻找灵感。他一直喜欢看罪犯从报纸上剪下字母，然后用这些字母拼勒索信的桥段。然而 Oscar 根本不想抄袭，所以他自己想了一个这种方法的变体。他觉得把字母一个一个拼成文本既无聊又费时间。所以他决定通过剪下一整个单词的方式拼出自己的勒索信。

Oscar 买来一些主流报纸，这样他几乎就有了无限的单词库。他可以多次剪出任意特定的单词。然而，他还是被报纸中出现的的单词集限制。问题是一些单词根本没在报纸中出现。为了让这项工作更简单，他决定去除勒索信中所有的标点符号和空格并且忽略字母的大小写。他同时允许剪出的单词互相重叠，只需要重叠部分相同。现在 Oscar 想知道他至少要剪下多少次单词才能拼成他想要的勒索信。
## 输入格式
第一行包含一个整数 $L$，表示在报纸中发现的单词数；

下一行包含勒索信的内容 $s$。保证内容非空并且只包含小写英文字母。

接下来 $L$ 行，每行包含一个在报纸中出现的单词 $a_i$，保证只出现小写英文字母。这些单词中没有空串，也没有比勒索信长的单词。所有报纸中单词在输入中出现至少一次。
## 输出格式
输出 Oscar 最少要从报纸中剪下多少次单词才能组成勒索信、如果不能组成，输出 $-1$ 。每个单词都要被记实际从报纸剪下那么多次。
#### 输入 \#1
```
3
aaaaa
a
aa
aaa
```
### 输出 \#1
```
2
```
### 输入 \#1
```
5
abecedadabra
abec
ab
ceda
dad
ra
```
### 输出 \#1
```
5
```
### 输入 \#1
```
9
icpcontesticpc
international
collegiate
programming
contest
central
europe
regional
contest
icpc
```
### 输出 \#1
```
3
```
## 说明/提示
$1≤L,|s|,∑|a_i|≤3×10^5$
# Vasya and Big Integers
## 题目描述
Vasya owns three big integers — $a, l, r$ . Let's define a partition of $x$ such a sequence of strings $s_1, s_2, \dots, s_k$ that $s_1 + s_2 + \dots + s_k = x$ , where $+$ is a concatanation of strings. $s_i$ is the $i$ -th element of the partition. For example, number $12345$ has the following partitions: \["1", "2", "3", "4", "5"\], \["123", "4", "5"\], \["1", "2345"\], \["12345"\] and lots of others.

Let's call some partition of $a$ beautiful if each of its elements contains no leading zeros.

Vasya want to know the number of beautiful partitions of number $a$ , which has each of $s_i$ satisfy the condition $l \le s_i \le r$ . Note that the comparison is the integer comparison, not the string one.

Help Vasya to count the amount of partitions of number $a$ such that they match all the given requirements. The result can be rather big, so print it modulo $998244353$ .
## 输入格式
The first line contains a single integer $a~(1 \le a \le 10^{1000000})$ .

The second line contains a single integer $l~(0 \le l \le 10^{1000000})$ .

The third line contains a single integer $r~(0 \le r \le 10^{1000000})$ .

It is guaranteed that $l \le r$ .

It is also guaranteed that numbers $a, l, r$ contain no leading zeros.
## 输出格式
Print a single integer — the amount of partitions of number $a$ such that they match all the given requirements modulo $998244353$ .
#### 输入 \#1
```
135
1
15

```
### 输出 \#1
```
2

```
### 输入 \#1
```
10000
0
9

```
### 输出 \#1
```
1

```
## 说明/提示
In the first test case, there are two good partitions $13+5$ and $1+3+5$ .

In the second test case, there is one good partition $1+0+0+0+0$ .
